{{!-- Rise of Arcane and Valor â€” NPC Sheet v0.2.1 --}}
<form class="sheet-form npc-form" autocomplete="off">

  {{!-- â”€â”€ HEADER â”€â”€ --}}
  <header class="npc-header">
    <div class="header-portrait">
      <img class="profile-img npc-portrait" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
    </div>
    <div class="npc-header-fields">
      <input class="name-input" type="text" name="name" value="{{actor.name}}" placeholder="NPC Name"/>
      <div class="npc-header-meta">
        <div class="meta-field">
          <label>Rarity</label>
          <select name="system.monsterTier">
            <option value="common"   {{#if (eq system.monsterTier "common")}}selected{{/if}}>Common</option>
            <option value="uncommon" {{#if (eq system.monsterTier "uncommon")}}selected{{/if}}>Uncommon</option>
            <option value="rare"     {{#if (eq system.monsterTier "rare")}}selected{{/if}}>Rare</option>
            <option value="ancient"  {{#if (eq system.monsterTier "ancient")}}selected{{/if}}>Ancient</option>
            <option value="mythical" {{#if (eq system.monsterTier "mythical")}}selected{{/if}}>Mythical</option>
          </select>
        </div>
        <div class="meta-field">
          <label>Type</label>
          <input type="text" name="system.monsterType" value="{{system.monsterType}}" placeholder="e.g. Beast, Undead"/>
        </div>
      </div>
    </div>
  </header>

  {{!-- â”€â”€ ATTRIBUTE BLOCK â”€â”€ --}}
  <section class="npc-stat-block">

    {{!-- Attribute row --}}
    <div class="npc-attributes">
      <div class="npc-attr">
        <span class="npc-attr-label attribute-roll" data-attribute="might">Might</span>
        <input type="number" name="system.attributes.might.value"
               value="{{system.attributes.might.value}}" min="1" max="20" class="npc-attr-value"/>
      </div>
      <div class="npc-attr">
        <span class="npc-attr-label attribute-roll" data-attribute="agility">Agility</span>
        <input type="number" name="system.attributes.agility.value"
               value="{{system.attributes.agility.value}}" min="1" max="20" class="npc-attr-value"/>
      </div>
      <div class="npc-attr">
        <span class="npc-attr-label attribute-roll" data-attribute="endurance">Endurance</span>
        <input type="number" name="system.attributes.endurance.value"
               value="{{system.attributes.endurance.value}}" min="1" max="20" class="npc-attr-value"/>
      </div>
      <div class="npc-attr">
        <span class="npc-attr-label attribute-roll" data-attribute="intellect">Intellect</span>
        <input type="number" name="system.attributes.intellect.value"
               value="{{system.attributes.intellect.value}}" min="1" max="20" class="npc-attr-value"/>
      </div>
      <div class="npc-attr">
        <span class="npc-attr-label attribute-roll" data-attribute="personality">Personality</span>
        <input type="number" name="system.attributes.personality.value"
               value="{{system.attributes.personality.value}}" min="1" max="20" class="npc-attr-value"/>
      </div>
    </div>

    {{!-- HP / MP / Order / Gear row â€” all free input --}}
    <div class="npc-vitals-row">

      <div class="npc-vital-cell">
        <span class="npc-vital-label">HP</span>
        <div class="npc-vital-controls">
          <button type="button" class="hp-btn vital-btn" data-delta="-1">âˆ’</button>
          <input type="number" name="system.health.value"
                 value="{{system.health.value}}" min="0" class="npc-vital-input"/>
          <span class="vital-sep">/</span>
          <input type="number" name="system.health.max"
                 value="{{system.health.max}}" min="0" class="npc-vital-input npc-max-input"
                 title="Set max HP freely"/>
          <button type="button" class="hp-btn vital-btn" data-delta="1">+</button>
        </div>
      </div>

      <div class="npc-vital-cell">
        <span class="npc-vital-label">MP</span>
        <div class="npc-vital-controls">
          <button type="button" class="mp-btn vital-btn" data-delta="-1">âˆ’</button>
          <input type="number" name="system.magic.value"
                 value="{{system.magic.value}}" min="0" class="npc-vital-input"/>
          <span class="vital-sep">/</span>
          <input type="number" name="system.magic.max"
                 value="{{system.magic.max}}" min="0" class="npc-vital-input npc-max-input"
                 title="Set max MP freely"/>
          <button type="button" class="mp-btn vital-btn" data-delta="1">+</button>
        </div>
      </div>

      <div class="npc-vital-cell">
        <span class="npc-vital-label">Order</span>
        <input type="number" name="system.order" value="{{system.order}}"
               min="0" max="20" class="npc-vital-input"/>
      </div>

      <div class="npc-vital-cell npc-gear-cell">
        <span class="npc-vital-label">Gear</span>
        <input type="text" name="system.gear" value="{{system.gear}}"
               placeholder="None" class="npc-gear-input"/>
      </div>

    </div>
  </section>

  {{!-- â”€â”€ TABS â”€â”€ --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="skills">Skills</a>
    <a class="item" data-tab="actions">Actions</a>
    <a class="item" data-tab="description">Description</a>
  </nav>

  <section class="sheet-body">

    {{!-- â”€â”€ TAB: SKILLS â”€â”€ --}}
    <div class="tab" data-tab="skills">
      <p class="npc-tab-hint">Each skill shows as <strong>Name.</strong> Description in the stat block.</p>

      <div class="npc-skill-list">
        {{#each system.npcSkills as |skill key|}}
        <div class="npc-skill-row" data-skill-key="{{key}}">
          <input type="text"
                 name="system.npcSkills.{{key}}.name"
                 value="{{skill.name}}"
                 placeholder="Skill name"
                 class="npc-skill-name-input"/>
          <input type="text"
                 name="system.npcSkills.{{key}}.description"
                 value="{{skill.description}}"
                 placeholder="What it does..."
                 class="npc-skill-desc-input"/>
          <a class="npc-skill-delete" data-skill-key="{{key}}" title="Remove">
            <i class="fas fa-trash"></i>
          </a>
        </div>
        {{/each}}
      </div>

      <div class="npc-skill-add-row">
        <button type="button" class="action-add-btn npc-skill-add-btn">+ Add Skill</button>
      </div>

      {{!-- READ-ONLY PREVIEW â€” shows how skills render in final stat block style --}}
      {{#if system.npcSkills}}
      <div class="npc-skill-preview">
        <h4 class="npc-preview-title">Preview</h4>
        {{#each system.npcSkills as |skill key|}}
        {{#if skill.name}}
        <p class="npc-skill-preview-line">
          <strong>{{skill.name}}.</strong> {{skill.description}}
        </p>
        {{/if}}
        {{/each}}
      </div>
      {{/if}}
    </div>

    {{!-- â”€â”€ TAB: ACTIONS â”€â”€ --}}
    <div class="tab" data-tab="actions">
      <div class="action-table">
        <div class="action-header">
          <span class="action-col-name">Attack / Defense</span>
          <span class="action-col-target">Target; Zone</span>
          <span class="action-col-roll">MP â€” Roll</span>
          <span class="action-col-ctrl"></span>
        </div>

        {{#each system.actions as |action key|}}
        <div class="action-row" data-action-key="{{key}}">
          <input type="text" name="system.actions.{{key}}.name"
                 value="{{action.name}}" placeholder="e.g. Sword" class="action-col-name action-input"/>
          <input type="text" name="system.actions.{{key}}.target"
                 value="{{action.target}}" placeholder="One; Adjacent" class="action-col-target action-input"/>
          <input type="text" name="system.actions.{{key}}.roll"
                 value="{{action.roll}}" placeholder="3d10 + 1" class="action-col-roll action-input"/>
          <div class="action-col-ctrl">
            <a class="action-roll-btn" data-action-key="{{key}}" title="Roll this action">ðŸŽ²</a>
            <a class="action-delete-btn" data-action-key="{{key}}" title="Remove">
              <i class="fas fa-trash"></i>
            </a>
          </div>
        </div>
        {{/each}}

        <div class="action-add-row">
          <button type="button" class="action-add-btn">+ Add Action</button>
        </div>
      </div>
    </div>

    {{!-- â”€â”€ TAB: DESCRIPTION â”€â”€ --}}
    <div class="tab" data-tab="description">
      <div class="npc-description-tab">
        <div class="npc-desc-portrait-wrap">
          <img class="npc-desc-portrait" src="{{actor.img}}" data-edit="img"
               title="Click to change portrait"/>
          <span class="npc-desc-portrait-hint">Click to change</span>
        </div>
        <div class="npc-desc-text-wrap">
          <label class="bio-label">Description &amp; Lore</label>
          <textarea name="system.biography" class="npc-textarea npc-bio-textarea"
                    placeholder="Describe this creature or NPC â€” its appearance, behaviour, habitat, legends surrounding it...">{{system.biography}}</textarea>
        </div>
      </div>
    </div>

  </section>
</form>
